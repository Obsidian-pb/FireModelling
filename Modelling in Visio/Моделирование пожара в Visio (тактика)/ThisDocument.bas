VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
'Public Sub drawCircle()
'
'Dim str As String
'Dim arr() As String
'
'
'    str = "10;0;9,998;0,175;9,994;0,349;9,986;0,523;9,976;0,698;9,962;0,872;9,945;1,045;9,925;1,219;9,903;1,392;9,877;1,564;9,848;1,736;9,816;1,908;9,781;2,079;9,744;2,25;9,703;2,419;9,659;2,588;9,613;2,756;9,563;2,924;9,511;3,09;9,455;3,256;9,397;3,42;9,336;3,584;9,272;3,746;9,205;3,907;9,135;4,067;9,063;" & _
'            "4,226;8,988;4,384;8,91;4,54;8,829;4,695;8,746;4,848;8,66;5;8,572;5,15;8,48;5,299;8,387;5,446;8,29;5,592;8,192;5,736;8,09;5,878;7,986;6,018;7,88;6,157;7,771;6,293;7,66;6,428;7,547;6,561;7,431;6,691;7,314;6,82;7,193;6,947;7,071;7,071;6,947;7,193;6,82;7,314;6,691;7,431;6,561;7,547;6,428;7,66;6,293;7,771;6,157;7,88;6,018;7,986;5,878;8,09;5,736;8,192;5,592;8,29;5,446;8,387;5,299;8,48;5,15;8,572;5;8,66;4,848;8,746;4,695;8,829;4,54;8,91;4,384;8,988;4,226;9,063;4,067;9,135;3,907;9,205;3,746;9,272;3,584;9,336;3,42;9,397;3,256;9,455;3,09;9,511;2,924;9,563;2,756;9,613;2,588;9,659;2,419;9,703;2,25;9,744;2,079;9,781;1,908;9,816;1,736;9,848;1,564;9,877;1,392;9,903;1,219;9,925;1,045;9,945;0,872;9,962;0,698;9,976;0,523;9,986;0,349;9," & _
'            "994;0,175;9,998;0;10;-0,175;9,998;-0,349;9,994;-0,523;9,986;-0,698;9,976;-0,872;9,962;-1,045;9,945;-1,219;9,925;-1,392;9,903;-1,564;9,877;-1,736;9,848;-1,908;9,816;-2,079;9,781;-2,25;9,744;-2,419;9,703;-2,588;9,659;-2,756;9,613;-2,924;9,563;-3,09;9,511;-3,256;9,455;-3,42;9,397;-3,584;9,336;-3,746;9,272;-3,907;9,205;-4,067;9,135;-4,226;9,063;-4,384;8,988;-4,54;8,91;-4,695;8,829;-4,848;8,746;-5;8,66;-5,15;8,572;-5,299;8,48;-5,446;8,387;-5,592;8,29;-5,736;8,192;-5,878;8,09;-6,018;7,986;" & _
'            "-6,157;7,88;-6,293;7,771;-6,428;7,66;-6,561;7,547;-6,691;7,431;-6,82;7,314;-6,947;7,193;-7,071;7,071;-7,193;6,947;-7,314;6,82;-7,431;6,691;-7,547;6,561;-7,66;6,428;-7,771;6,293;-7,88;6,157;-7,986;6,018;-8,09;5,878;-8,192;5,736;-8,29;5,592;-8,387;5,446;-8,48;5,299;-8,572;5,15;-8,66;5;-8,746;4,848;-8,829;4,695;-8,91;4,54;-8,988;4,384;-9,063;4,226;-9,135;4,067;-9,205;3,907;-9,272;3,746;-9,336;3,584;-9,397;3,42;-9,455;3,256;-9,511;3,09;-9,563;2,924;-9,613;2,756;-9,659;2,588;-9,703;2,419;-9,744;2,25;-9,781;2,079;-9,816;1,908;-9,848;1," & _
'            "736;-9,877;1,564;-9,903;1,392;-9,925;1,219;-9,945;1,045;-9,962;0,872;-9,976;0,698;-9,986;0,523;-9,994;0,349;-9,998;0,175;-10;0;-9,998;-0,175;-9,994;-0,349;-9,986;-0,523;-9,976;-0,698;-9,962;-0,872;-9,945;-1,045;-9,925;-1,219;-9,903;-1,392;-9,877;-1,564;-9,848;-1,736;-9,816;-1,908;-9,781;-2,079;-9,744;-2,25;-9,703;-2,419;-9,659;-2,588;-9,613;-2,756;-9,563;-2,924;-9,511;-3,09;-9,455;-3,256;-9,397;-3,42;-9,336;-3,584;-9,272;-3,746;-9,205;-3,907;-9,135;-4,067;" & _
'            "-9,063;-4,226;-8,988;-4,384;-8,91;-4,54;-8,829;-4,695;-8,746;-4,848;-8,66;-5;-8,572;-5,15;-8,48;-5,299;-8,387;-5,446;-8,29;-5,592;-8,192;-5,736;-8,09;-5,878;-7,986;-6,018;-7,88;-6,157;-7,771;-6,293;-7,66;-6,428;-7,547;-6,561;-7,431;-6,691;-7,314;-6,82;-7,193;-6,947;-7,071;-7,071;-6,947;-7,193;-6,82;-7,314;-6,691;-7,431;-6,561;-7,547;-6,428;-7,66;-6,293;-7,771;-6,157;-7,88;-6,018;-7,986;-5,878;-8,09;-5,736;-8,192;-5,592;-8,29;-5,446;-8,387;-5,299;-8,48;-5,15;-8,572;-5;-8,66;-4,848;-8,746;-4,695;-8,829;-4,54;-8,91;-4,384;-8,988;-4,226;-9,063;-4,067;-9,135;-3," & _
'            "907;-9,205;-3,746;-9,272;-3,584;-9,336;-3,42;-9,397;-3,256;-9,455;-3,09;-9,511;-2,924;-9,563;-2,756;-9,613;-2,588;-9,659;-2,419;-9,703;-2,25;-9,744;-2,079;-9,781;-1,908;-9,816;-1,736;-9,848;-1,564;-9,877;-1,392;-9,903;-1,219;-9,925;-1,045;-9,945;-0,872;-9,962;-0,698;-9,976;-0,523;-9,986;-0,349;-9,994;-0,175;-9,998;0;-10;0,175;-9,998;0,349;-9,994;0,523;-9,986;0,698;-9,976;0,872;-9,962;1,045;-9,945;1,219;-9,925;1,392;-9,903;1,564;-9,877;1,736;-9,848;" & _
'            "1,908;-9,816;2,079;-9,781;2,25;-9,744;2,419;-9,703;2,588;-9,659;2,756;-9,613;2,924;-9,563;3,09;-9,511;3,256;-9,455;3,42;-9,397;3,584;-9,336;3,746;-9,272;3,907;-9,205;4,067;-9,135;4,226;-9,063;4,384;-8,988;4,54;-8,91;4,695;-8,829;4,848;-8,746;5;-8,66;5,15;-8,572;5,299;-8,48;5,446;-8,387;5,592;-8,29;5,736;-8,192;5,878;-8,09;6,018;-7,986;6,157;-7,88;6,293;-7,771;6,428;-7,66;6,561;-7,547;6,691;-7,431;6,82;-7,314;6,947;-7,193;7,071;-7,071;7,193;-6,947;7,314;-6,82;7,431;-6,691;7,547;-6,561;7,66;-6,428;7,771;-6,293;7,88;-6,157;7,986;-6,018;8,09;-5,878;8,192;-5,736;8,29;-5" & _
'            ",592;8,387;-5,446;8,48;-5,299;8,572;-5,15;8,66;-5;8,746;-4,848;8,829;-4,695;8,91;-4,54;8,988;-4,384;9,063;-4,226;9,135;-4,067;9,205;-3,907;9,272;-3,746;9,336;-3,584;9,397;-3,42;9,455;-3,256;9,511;-3,09;9,563;-2,924;9,613;-2,756;9,659;-2,588;9,703;-2,419;9,744;-2,25;9,781;-2,079;9,816;-1,908;9,848;-1,736;9,877;-1,564;9,903;-1,392;9,925;-1,219;9,945;-1,045;9,962;-0,872;9,976;-0,698;9,986;-0,523;9,994;-0,349;9,998;-0,175;10;0"
'
'    arr = Split(str, ";")
'
'    Dim arrD(721) As Double
'    For i = 0 To 721
'        arrD(i) = CDbl(arr(i))
'    Next i
'
'
''    Dim arrD(5) As Double
''    arr = Split("10,0,11,5,6,7", ",")
''    For i = 0 To 5
''        arrD(i) = CDbl(arr(i))
''    Next i
'
'
'
'
''    Application.ActivePage.DrawSpline arrD, 0.25, visSplineAbrupt
'    Application.ActivePage.DrawPolyline arrD, visPolyline1D
'
'End Sub


Dim fireModeller As c_Modeller
Const grain As Integer = 10

Public Sub MakeMatrix()

Dim matrix() As Variant
Dim matrixObj As c_Matrix
Dim matrixBuilder As c_MatrixBuilder

    '---Подключаем таймер
    Dim tmr As c_Timer
    Set tmr = New c_Timer

'    Dim UndoScopeID1 As Long
'    UndoScopeID1 = Application.BeginUndoScope("Визуализация матрицы")


    Set matrixBuilder = New c_MatrixBuilder
    matrix = matrixBuilder.NewMatrix(grain)

    Set matrixObj = New c_Matrix
    matrixObj.CreateMatrix UBound(matrix, 1), UBound(matrix, 2)
    matrixObj.SetOpenSpace matrix

'    matrixObj.SetFireCell 0, 2
    
    
    
    Set fireModeller = New c_Modeller
    fireModeller.SetMatrix matrixObj
'    fireModeller.SetFireCell 110, 120
    
    fireModeller.SetFireCell 110, 110
'    fireModeller.SetFireCell 60, 75
'    fireModeller.SetFireCell 60, 85
'    fireModeller.SetFireCell 60, 95
'    fireModeller.SetFireCell 60, 105
'    fireModeller.SetFireCell 60, 115
'    fireModeller.SetFireCell 60, 125
'    fireModeller.SetFireCell 60, 135
    fireModeller.grain = grain



    '---Печатаем сколько потребовалось времени
    Debug.Print "Матрица запечена..."
    tmr.PrintElapsedTime
    Set tmr = Nothing


End Sub

Public Sub RoundFire()
    '---Подключаем таймер
    Dim tmr As c_Timer, tmr2 As c_Timer
    Set tmr = New c_Timer
    Set tmr2 = New c_Timer
    
    Dim i As Integer
    Dim j As Integer
    For i = 0 To 400
        ClearLayer "Огонь"
        For j = 0 To 1
            ClearLayer "Угловые точки"
            fireModeller.OneRound
        Next j

        '---Печатаем сколько потребовалось времени
        Debug.Print i & ") горит " & fireModeller.GetFiredCellsCount & ", активно " & fireModeller.GetActiveCellsCount & ". Прошло " & tmr2.GetElapsedTime & "с."
'        tmr.PrintElapsedTime
        
        Application.ActiveWindow.DeselectAll
        DoEvents
    Next i
        
    Debug.Print "Всего затрачено " & tmr2.GetElapsedTime & "с."
    
    Set tmr = Nothing
    Set tmr2 = Nothing
End Sub

Public Sub DestroyMatrix()
    Set fireModeller = Nothing
End Sub




'Public Sub testMatrixCreation()
'Dim matrix As c_Matrix
'
'    '---Подключаем таймер
'    Dim tmr As c_Timer
'    Set tmr = New c_Timer
'
'    Set matrix = New c_Matrix
'    matrix.CreateMatrix 1000, 1000
'
'    '---Печатаем сколько потребовалось времени
'    tmr.PrintElapsedTime
'    Set tmr = Nothing
'End Sub



'
'Public Sub HitTestTest()
'Dim shp As Visio.Shape
'
'    Set shp = Application.ActivePage.Shapes(1)
'
'    Debug.Print shp.HitTest(1500 / 25.4, 1500 / 25.4, 100000)
'End Sub
